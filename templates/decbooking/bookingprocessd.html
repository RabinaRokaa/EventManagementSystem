<!-- booking_list.html -->

{% load static %}
 <!DOCTYPE html>
 <html lang="en">
 <head>
     <meta charset="UTF-8">
     <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <title>booking list</title>
     <link rel="stylesheet" href="{% static 'css/bookinglist.css' %}">
     <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
     <link rel="icon" type="image/x-icon" href="assets/favicon.ico" />
     <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
     <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
     <!-- Font Awesome icons (free version)-->
     <script src="https://use.fontawesome.com/releases/v5.15.3/js/all.js" crossorigin="anonymous"></script>
     <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
     <script src="https://khalti.s3.ap-south-1.amazonaws.com/KPG/dist/2020.12.17.0.0.0/khalti-checkout.iffe.js"></script>
     <!-- Font Awesome icons (free version)-->
    
     <style>

        .modal-content, .modal-header, .modal-body, .modal-footer {
            font-family: 'Inter', sans-serif;
          }
        
          .modal-content {
            background-color: #ffffff; /* Change background color to white */
          }

          #bookingSuccessModal{
            background-color: #ffffff;
          }
       

        /* Inline CSS styles */
        .container {
            display: flex;
            justify-content: center;
            /* gap: 0.2rem; */

        }
        
        #btn{
            padding: 10px;
            /* margin-left:600px; */
            margin: auto;
            display: block;
            margin: auto;
            padding: 10px 20px;
            background-color: #007bff;
            color: #fff;
            border: none;
            border-radius: 5px;
            cursor: pointer;

        }

        #close_btn{
            color:white;
            background-color:blue;

        }
        
        .left-column{
            
            padding: 10px;
            /* margin-left:145px; */

        }
        .right-column {
            flex: 1;
            padding: 10px;
            margin-right:100px;
        }
        
        #bookingDetails,
        #priceDetails {
            
            padding: 10px;
            margin-bottom: 20px;
        }
        
        #eventDetails{
            padding: 10px;
            margin-bottom: 0px;
        }

        #userDetails {
            border: 1px solid #e7e7e7;
            padding: 10px;
            margin-bottom: 20px;
        }
        
        .event-container {
            border: 1px solid #e7e7e7;
            padding: 10px;
            margin-bottom: 20px;
            align-items:center;
            display:flex;
        }
        .event-heading {
            font-size: 20px;
            font-weight: bold;
            /*margin-left:50%;*/
            margin:10px;
        }
        .event-detail {
            font-size: 16px;
            margin-bottom: 5px;
            /*margin-left:50%;*/
        }
        .user-heading {
            font-size: 20px;
            font-weight: bold;
            margin-left:50%;
            margin:10px;
        }
        .user-detail {
            font-size: 16px;
            margin-bottom: 5px;
            margin-left:50%;
        }

        event-check{
            border : 1px solid black;
        }
        .booking-container {
            border: 1px solid #e7e7e7;
            padding: 10px;
            width:300px;
        }
        .booking-details-container{
            border: 1px solid #e7e7e7;

        }
        .cost-details-container{
            border: 1px solid #e7e7e7;

        }
        
        
        .booking-details-box {
            margin-top:9px;
            display: flex;
            flex-direction: column;
        }
        .cost-container {
            border: 1px solid #e7e7e7;
            padding: 10px;
            width:300px;
        }
        
        .cost-details-box {
            margin-top:9px;
            display: flex;
            flex-direction: column;
        }
        
        .date-label {
            font-weight: bold;
        }
        
        .date {
            margin-left: 5px;
        }
        .span{
            margin-top:13px;
        }
        .facility ul {
            list-style-type: none; /* Remove default bullet points */
            padding: 0;
        }
        
        .facility ul li {
            display: inline-block; /* Display list items horizontally */
            margin-right: 20px; /* Add space between list items */
        }
        
        .facility ul li:last-child {
            margin-right: 0; /* Remove margin for the last list item */
        }
        .material-symbols-outlined{
            font-size:14px;

        }
        /* Navbar styles */
nav {
    /* background-color: #003b95; */
    padding: 20px; /* Increase padding to make navbar larger */
    color:black;
    text-align: center;
    position: relative; /* Ensure proper positioning for absolute elements */
    border-radius: 10px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    
}

nav a {
    text-decoration: none;
    color: white;
    margin: 0 15px;
    font-weight: bold;
}

nav a:hover {
    color: blue; /* Change to the desired color when hovering */
}

/* Dropdown content */
.hover-content {
    display: none;
    position: absolute;
    top: calc(100% + 5px); /* Position below the "Services" link */
    background-color: #de5b6854;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    padding: 10px;
}

.service-item {
    margin-bottom: 5px;
}



.service-item a:hover {
    color: blue;
}


/* Navbar styles */
nav {
    transition: all 300ms cubic-bezier(0.075, 0.82, 0.165, 1);
    
    padding: 30px; /* Increase padding to make navbar larger */
    color: white;
    text-align: center;
    position: relative; /* Ensure proper positioning for absolute elements */
    /* border: 1px black;
    box-shadow: 2px 2px 4px 2px rgba(139, 69, 19, 0.5); */
    
    font-weight: normal;
}

nav button {
    background-color: rgb(3, 10, 18);
}

nav a {
    text-decoration: none;
    /* color: rgb(110, 110, 108); */
    color:black;
    margin: 0 15px;
    font-weight: normal;
    
}


.nav a:after,
.nav a:before {
  content: "";
  position: absolute;
  display: block;
  border: 0px solid transparent;
}

.nav a:after {
  width: 0%;
  height: 80%;
  border-top: 2px solid #fff;
  border-bottom: 2px solid #fff;
  transition: all 0.3s ease;
}

.nav a:before {
  width: 120%;
  height: 0%;
  border-left: 2px solid #fff;
  border-right: 2px solid #fff;
  transition: all 0.5s ease;
}

.nav a:hover::before {
  height: 80%;
}

.nav a:hover::after {
  width: 120%;
}

/* Dropdown content */
.hover-content {
    display: none;
    position: absolute;
    top: 85%;
    background-color: #fff;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    padding: 10px;
    margin-left: 40px;
}

.hover-trigger:hover + .hover-content,
.hover-content:hover {
    display: block;
}

.service-item {
    margin-bottom: 5px;
}



.service-item a:hover {
    color: blue;
}


.logo_img {
        height: auto;
        width: 100px;
        display: block;

    }

    .breadcrumbs {
    margin-top: 30px; /* Add margin to create space between breadcrumbs and form elements */
}
.material-symbols-outlined {
    vertical-align: middle; /* Adjust the vertical alignment */
    margin-left: 5px; /* Optional: Add some horizontal spacing between the arrow and the label */
}
.breadcrumbs li{
    display: inline;
    
    
}
.breadcrumbs ul{
    margin: 0;
    padding: 0; 
    display:inline;
    
}

#overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5); /* Adjust the opacity as needed */
    backdrop-filter: blur(8px); /* Adjust the blur effect as needed */
    z-index: 999;
    display: none;
}

#messageman {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 1000; /* Ensure the image is on top of the overlay */
    display: none;
    width: 150px;
    height: auto;
}
        
    </style>
 </head>
 <nav style="display: flex; align-items: center; justify-content: space-between; margin-top: -50px;">
    <div class="logo" style="display: flex;align-items: center;justify-content: center; margin-bottom: -50px;">
        <img class="logo_img" src="{% static 'images/logoa.png' %}">
        <div>
            <a href="/">Home</a>

            <a href="#" class="hover-trigger">Services</a>
            <div class="hover-content">
                <div class="service-item">
                    <a href="/venue">Venues</a>
                </div>
                <div class="service-item">
                    <a href="/decorations">Decoration</a>
                </div>
                <div class="service-item">
                    <a href="/photographers">Photographer</a>
                </div>
            </div>
            <a href="/about_us">About Us</a>
            <a href="/contact">Contact</a>
        </div>
    </div>


    <div style="margin-bottom: -50px;">
        {% if user.is_authenticated %}
          <!-- User is logged in, so don't show login and register links -->
        {% else %}
          <a href="/Register">Register</a>
          <a href="/Login">LogIn</a>
        {% endif %}
    </div>
</nav>

 <body>
   {% comment %} <div id="eventDetails"></div> 
   <div id="userDetails"></div>  {% endcomment %}
   <p id='usernames' style="opacity:0">{{ username }}</p>
   {% comment %} <p id='firstname' style="opacity:0">{{ first_name }}</p>
   <p id='lastname' style="opacity:0">{{ last_name }}</p>
   <p id='email' style="opacity:0">{{ email }}</p> {% endcomment %}
   <p id='firstname' style="opacity:0">{{ request.user.first_name }}</p>
   <p id='lastname' style="opacity:0">{{ request.user.last_name }}</p>
   <p id='email' style="opacity:0">{{ request.user.email }}</p>
   {% comment %} <p id='phonenumber' style="opacity:0">{{ request.user.phone_number }}</p> {% endcomment %}


   <input type="text" id="username" style="opacity:0" value="{{ username }}">
   <input type="text" id="emailpp" style="opacity:0" value="{{ request.user.email }}">
   <input type="text" id="phone"  style="opacity:0" value="...">

   <div class="container">
       <div class="left-column">
        <img src="https://plus.unsplash.com/premium_photo-1661315459644-18297c559777?q=80&w=2000&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D" alt=""  style="width:500px;height: auto;">
        <div id="bookingDetails" style="width:300px;margin-left: -13px;"></div>
        <div id="priceDetails" style="width:300px;margin-left: -13px;"></div>
        <button id="payment-button">Pay with Khalti</button>
        
    </div>
    <div class="right-column" >
        <div id="eventDetails" style="width: 500px;max-width: 80vw;"></div>
        <div id="userDetails"></div>
        
    </div>
   </div>

   <div style="display: flex;align-items: center;justify-content: left;width: 200px;margin-left: 48vw;">
       <button id="btn">Book Now </button>
      <img id="loading_image"  style="width:80px;height: auto;visibility: hidden;" src="https://th.bing.com/th/id/R.400472888ff31541d8d8bafe1481538b?rik=mtxVa7PUxEVTxw&pid=ImgRaw&r=0" alt="">
</div>
<div id="overlay"></div>

   <img src="https://th.bing.com/th/id/R.400472888ff31541d8d8bafe1481538b?rik=mtxVa7PUxEVTxw&pid=ImgRaw&r=0" id="messageman" style="display: none;" alt="">
   
    <div class="modal fade" id="bookingSuccessModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="exampleModalLongTitle" style="margin-left:150px; display:block;">Booking Successful</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body" style="margin:auto; display:block;">
              Your booking has been successfully submitted.
              <br>You can also check your mail for the further confirmation.
            </div>
            <div class="color">
                <img src="{% static 'images/success.png' %}" style="width: 50px; height: 50px; margin:auto; display:block;">
                </div>
            <div class="modal-footer" style="font-size:100px;">
              <button type="button" class="btn btn-secondary" data-dismiss="modal" id="close_btn" >Close</button>
            </div>
          </div>
        </div>
      </div>
    
      <!-- Bootstrap JS and jQuery -->
      <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
      <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
 </body>
 

 <script>
        const storedFormDataJson = localStorage.getItem('formData');
        const formData = JSON.parse(storedFormDataJson);
        const eventContainer = document.createElement('div');
    
        eventContainer.classList.add('event-container');

        /*const eventHeading = document.createElement('div');
        eventHeading.classList.add('event-heading');
        eventHeading.textContent = formData.name;
        eventContainer.appendChild(eventHeading);

        /*const eventCheck = document.createElement('div');
        eventCheck.classList.add('venue-image');
        eventCheck.textContent = `Start Date: ${formData.venue_image}, End Date: ${formData.end_date}`;
        eventContainer.appendChild(eventCheck);*/

        // Create and append the image element
        /*if (formData.Venue_image) {
            const imageElement = document.createElement('img');
            imageElement.src = formData.Venue_image;
            imageElement.alt = formData.name;
            eventContainer.appendChild(imageElement);
        }*/

          // Create an img element for the venue image
        // const venueImage = document.createElement('img');
        // venueImage.src = formData.Venue_image; // Assuming Venue_image contains the URL of the image
        // venueImage.alt = 'Venue Image';
        // eventContainer.appendChild(venueImage); // Append the image to the eventContainer


        const eventDetails = document.createElement('div');
        eventDetails.classList.add('event-detail');
        eventDetails.innerHTML = `
        <p><strong> <h2>${formData.name}</h2></strong></p>
        <br>
        <p style="opacity:1"><strong> <input id="decoration_id">${formData.id}</input></strong></p>
        <br>
        <p ><strong></strong> ${formData.description} </p>
       
        <br>
            <p style="font-style:underline;"><strong></strong> ${formData.location}</p>
            <br>
            <div class="facility">   
                <ul>
                    <li><span class="material-symbols-outlined" style="color:blue">wifi</span>Free wifi</li>
                    <li><span class="material-symbols-outlined" style="color:green">lock</span>Security</li>
                    <li><span class="material-symbols-outlined" style="color:orange">restaurant</span>Restaurants</li>
                    <li><span class="material-symbols-outlined" style="color:purple">garage_home</span>Free Parking</li>
                    <br>
                    <li><span class="material-symbols-outlined" style="margin-top:20px;color:blueviolet">mode_fan</span>AC</li>
                </ul>
            </div>
            
            
            <br>
            
           
            
        `;
        eventContainer.appendChild(eventDetails);


        document.getElementById('eventDetails').appendChild(eventContainer);
 </script>
<script>

        let checkin=""
        let checkout=""
            // Create booking details container
        const bookingDetailsContainer = document.createElement('div');
        bookingDetailsContainer.classList.add('booking-details-container');

        // Create heading element for booking details
        const bookingDetailsHeading = document.createElement('h2');
        bookingDetailsHeading.textContent = 'Booking Details';

        // Append the heading to the booking details container
        bookingDetailsContainer.appendChild(bookingDetailsHeading);

        // Create booking container
        const bookingContainer = document.createElement('div');
        bookingContainer.classList.add('booking-container');

        // Create sub-box for check-in and check-out
        const bookingDetailsBox = document.createElement('div');
        bookingDetailsBox.classList.add('booking-details-box');
        const breakline=document.createElement('br')
        // Check-in date
        const checkInLabel = document.createElement('h2');
        checkInLabel.textContent = 'Date ';
        checkInLabel.style.fontWeight = '100'; 
        const checkInDate = document.createElement('span');
        checkInDate.textContent = formData.date.split("T")[0]; // Assuming formData.date contains check-in date
        checkin=formData.date.split("T")[0];
        checkInDate.style.marginTop = '10px';
        bookingDetailsBox.appendChild(checkInLabel);
        bookingDetailsBox.appendChild(checkInDate);
        bookingDetailsBox.appendChild(breakline)
        
        // Check-out date
        const checkOutLabel = document.createElement('h2');
        checkOutLabel.textContent = 'End Date ';
        checkOutLabel.style.marginTop = '10px';
        checkOutLabel.style.fontWeight = '100'; 
        const checkOutDate = document.createElement('span');
        checkOutDate.textContent = formData.end_date.split("T")[0]; // Assuming formData.end_date contains check-out date
        checkout=checkOutDate.textContent
        
        checkOutDate.style.marginTop = '10px';
        bookingDetailsBox.appendChild(checkOutLabel);
        bookingDetailsBox.appendChild(checkOutDate);

        // Append the booking details box to the booking container
        bookingContainer.appendChild(bookingDetailsBox);

        // Append the booking container to the booking details container
        bookingDetailsContainer.appendChild(bookingContainer);
        // Append the booking details container to the event container (assuming eventContainer is already defined)
        eventContainer.appendChild(bookingDetailsContainer);
        document.getElementById('bookingDetails').appendChild(bookingDetailsContainer);
</script>
<script>
            // Create booking details container
        const costDetailsContainer = document.createElement('div');
        costDetailsContainer.classList.add('cost-details-container');

        // Create heading element for cost details
        const costDetailsHeading = document.createElement('h2');
        costDetailsHeading.textContent = 'Cost Details';

        // Append the heading to the cost details container
        costDetailsContainer.appendChild(costDetailsHeading);

        // Create cost container
        const costContainer = document.createElement('div');
        costContainer.classList.add('cost-container');



        // Create heading element for booking details
         console.log("hello rabina",checkin,checkout)

        // Create sub-box for check-in and check-out
        const costDetailsBox = document.createElement('div');
        costDetailsBox.classList.add('cost-details-box');

        // Check-in date
        const costInLabel = document.createElement('h2');
        costInLabel.textContent = 'Total price ';
        costInLabel.style.fontWeight = '100'; 
        const costInDate = document.createElement('span');
        var checkinDate = new Date(checkin);
        var checkoutDate = new Date(checkout);
        var timeDifference = checkoutDate.getTime() - checkinDate.getTime();

// Convert milliseconds to days
var daysDifference = timeDifference / (1000 * 3600 * 24);
        let totalcost=daysDifference*Number(formData.cost)
        costInDate.textContent = `रू ${totalcost}`; // Assuming formData.date contains cost-in date
        costInDate.style.fontWeight="bold"
        costInDate.style.marginTop = '10px';
        costInDate.style.color = 'green';
        costDetailsBox.appendChild(costInLabel);
        let costmsg = document.createElement("p")

        if (daysDifference > 1){
            costmsg.innerHTML = `Your cost per day is रू ${formData.cost} <br><br> Now, you have booked for ${daysDifference} days <br>so your total cost is रू ${totalcost}` 
            costDetailsBox.appendChild(costmsg);
        }
      
        costDetailsBox.appendChild(costInDate);

        // Append the cost details box to the cost container
        costContainer.appendChild(costDetailsBox);

        // Append the cost container to the cost details container
        costDetailsContainer.appendChild(costContainer);
        // Append the cost details container to the event container (assuming eventContainer is already defined)
        eventContainer.appendChild(costDetailsContainer);
        document.getElementById('priceDetails').appendChild(costDetailsContainer);
       

</script>

 <script> 

     
        // Create container element for user details
        const userDetailsContainer = document.createElement('div');
        userDetailsContainer.classList.add('registration-form');


        // Create heading for user details
        const userDetailsHeading = document.createElement('h2');
        userDetailsHeading.textContent = 'Your Details';
        userDetailsHeading.style.margin = '10px';
        userDetailsContainer.appendChild(userDetailsHeading);


        // Function to create input elements

        function createInput(labelText, value, type) {
        const inputGroup = document.createElement('div');
        inputGroup.classList.add('input-group');
        
        
        const label = document.createElement('label');
        label.textContent = labelText + ':';
        label.style.fontSize = '16px';
        label.style.marginTop = '16px';
        inputGroup.appendChild(label);

        const input = document.createElement('input');
        input.type = type;
        input.value = value;
        input.style.width = '95%';
        input.style.padding = '10px';
        input.style.marginTop = '10px';
        input.style.fontSize = '14px';
        input.style.borderRadius = '5px';
        input.style.border = '1px solid #ccc';

        inputGroup.appendChild(input);
        userDetailsContainer.appendChild(inputGroup);
        }

        // Create input elements for user details
    createInput('Username',document.getElementById('usernames').textContent,'text')
    createInput('First Name',document.getElementById('firstname').textContent,'text')
    createInput('Last Name',document.getElementById('lastname').textContent,'text')
    createInput('Email',document.getElementById('email').textContent,'text'),
    //createInput('Phone Number',document.getElementById('phonenumber').textContent,'text');
        //createInput('Phone Number', formData.PhoneNumber, 'text');
    

        // Append the userDetailsContainer to the event container (assuming eventContainer is already defined)
        eventContainer.appendChild(userDetailsContainer);
        document.getElementById('userDetails').appendChild(userDetailsContainer);

 </script> 
<script>
    document.getElementById("btn").addEventListener('click', ((e) => {
      const storedFormDataJson = localStorage.getItem('formData');
      const formData = JSON.parse(storedFormDataJson);
      console.log(formData.name)
      // Create HTML elements to display the data

      document.getElementById("loading_image").style.visibility="visible"
      fetch('/bookingprocessd/', {
          method: 'POST',
          body: JSON.stringify(formData)
        })
        .then(response => {
          if (response.ok) {
            return response.json();
          }
          throw new Error('Network response was not ok.');
        })
        .then(data => {
          // Handle success response from the backend
          document.getElementById("loading_image").style.visibility="hidden"
          console.log(data.message); // Log the success message
          var modal = document.getElementById('bookingSuccessModal');
          modal.classList.add('show');
          modal.style.display = 'block';
          var backdrop = document.createElement('div');
          backdrop.classList.add('modal-backdrop');
          document.body.appendChild(backdrop);
          document.body.classList.add('modal-open');
          // You can perform any other actions here upon successful booking
          localStorage.removeItem('formData');
          // You can perform any other actions here upon successful booking

        })
        .catch(error => {
          // Handle error response from the backend
          console.error('There was a problem with the booking:', error.message);
          // You can display an error message to the user or perform other actions
        });
    }))


    document.getElementById("close_btn").addEventListener('click',(()=>{
        window.location.href='/userdashboard';
    }))
  </script>
      <script>
        document.addEventListener("DOMContentLoaded", function () {
            var trigger = document.querySelector('.hover-trigger');
            var content = document.querySelector('.hover-content');
            trigger.addEventListener('click', function () {
                if (content.style.display === "block") {
                    content.style.display = "none";
                } else {
                    content.style.display = "block";
                }
            });
        });
    </script>

<script>

    // const email = document.getElementById("emailpp").value;
     
    //             console.log(email, "kkkkkkkkkkkkkkk")
         var config = {
             // replace the publicKey with yours
             "publicKey": "test_public_key_4de009cbe3004274b69e6c34a6de7595",
             "productIdentity": "1234567890",
             "productName": "Dragon",
             "productUrl": "http://gameofthrones.wikia.com/wiki/Dragons",
             "paymentPreference": [
                 "KHALTI",
                 "EBANKING",
                 "MOBILE_BANKING",
                 "CONNECT_IPS",
                 "SCT",
                 ],
             "eventHandler": {
                  onSuccess(payload) {
                     console.log("payload:", payload)
                     const decoration_id = formData.id;
                     const date = formData.date.split("T")[0]
                     const end_date = formData.end_date.split("T")[0];
                     const name = document.getElementById("username").value;
                     const email = document.getElementById("emailpp").value;
                     const phone = document.getElementById("phone").value;
     
                            console.log(date, end_date, name, decoration_id , "kkkkkkkkkkkkkkk")
                             // Retrieve form data from localStorage
                    // const storedFormDataJson = localStorage.getItem('formData');
                    // const formData = JSON.parse(storedFormDataJson);
    
                    // // Extract required data from formData
                    // const { location, capacity, description } = formData;
    
    
                     // hit merchant api for initiating verfication
                     const data = {
                         date:date,
                         enddate:end_date,
                         decoration: decoration_id, // Use venue_id from your script
                        // venue_location: location, // Use location from formData
                        // venue_capacity: capacity, // Use capacity from formData
                        // venue_description: description, // Use description from formData
                         name: username,
                         email: email,
                        //  phone: phone,
                     };
     
                     // Combine payload and additional data into a single object
                     const body = {
                         ...payload,
                         ...data
                     };
     
                     console.log("stringify", JSON.stringify(body));

                                             // Show the overlay and the image
document.getElementById('overlay').style.display = 'block';
document.getElementById('messageman').style.display = 'block';
     
                      fetch("{% url 'decbooking:verify_paymentd' %}", {
                         method: 'post',
                         headers: {
                             'Content-Type': 'application/json'
                         },
                         body: JSON.stringify(body)
                     })

                        .then((response) => {
                        
                        
                        document.getElementById("messageman").style.display="none" 
                        document.getElementById('overlay').style.display = 'none';

                        var modal = document.getElementById('bookingSuccessModal');
          modal.classList.add('show');
          modal.style.display = 'block';
          var backdrop = document.createElement('div');
          backdrop.classList.add('modal-backdrop');
          document.body.appendChild(backdrop);
          document.body.classList.add('modal-open');
          // You can perform any other actions here upon successful booking
          localStorage.removeItem('formData');
          // You can perform any other actions here upon successful booking
                       // Redirect to another page after successful payment
 
                       console.log('heloooooooooooooo')
                        response.json()
              })

                         .then(response => response.json())
                          
                   .then(data => {
                       console.log(data);
                       if (data.status) {
                            // Handle success response from the backend
                            document.getElementById("loading_image").style.visibility="hidden"
                            console.log(data.message); // Log the success message
                            var modal = document.getElementById('bookingSuccessModal');
                            modal.classList.add('show');
                            modal.style.display = 'block';
                            var backdrop = document.createElement('div');
                            backdrop.classList.add('modal-backdrop');
                            document.body.appendChild(backdrop);
                            document.body.classList.add('modal-open');
                            // You can perform any other actions here upon successful booking
                            localStorage.removeItem('formData');
                            // You can perform any other actions here upon successful booking
                                        // Redirect to another page after successful payment
     
                           console.log('heloooooooooooooo')
                           // Open Bootstrap modal
                             
                       }
                   })
                 },
                 onError (error) {
                     console.log(error);
                 },
                 onClose () {
                     console.log('widget is closing');
                 }
             }
         };
     
    
         var checkoutkhalti = new KhaltiCheckout(config);
         var btn = document.getElementById("payment-button");
         btn.onclick = function (e) {
             e.preventDefault();
             // minimum transaction amount must be 10, i.e 1000 in paisa.
             checkoutkhalti.show({amount: 1000});
         }
    
    </script>
</html>