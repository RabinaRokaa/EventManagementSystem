{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Event Management System</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
    <link rel="icon" type="image/x-icon" href="assets/favicon.ico" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
<style>
    h1{
        font-weight: 800;
        font-size: 2rem;
    }
    
    h2{
        
        font-size: 1.4rem;
        
    }
    
    h3{
        
        font-size: 1.2rem;
    }
    
    h4{
        
        font-size: 1rem;
    }
    
    h5{
        
        font-size: 0.8rem;
    }
    small{
        font-size: 0.75rem;
    }
    
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            overflow-x: hidden; /* Add this line to prevent horizontal scrolling */
        }
/* Navbar styles */
nav {
    /* background-color: #003b95; */
    padding: 20px; /* Increase padding to make navbar larger */
    color:black;
    text-align: center;
    position: relative; /* Ensure proper positioning for absolute elements */
    border-radius: 10px;
     box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    
}

nav a {
    text-decoration: none;
    color: white;
    margin: 0 15px;
    font-weight: bold;
    font-size: large;
}

nav a:hover {
    color: blue; /* Change to the desired color when hovering */
}



.service-item {
    margin-bottom: 5px;
}



.service-item a:hover {
    color: blue;
}


/* Navbar styles */
nav {
    transition: all 300ms cubic-bezier(0.075, 0.82, 0.165, 1);
    
    padding: 30px; /* Increase padding to make navbar larger */
    color: white;
    text-align: center;
    position: relative; /* Ensure proper positioning for absolute elements */
    /* border: 1px black;
    box-shadow: 2px 2px 4px 2px rgba(139, 69, 19, 0.5); */
    
    font-weight: normal;
}

nav button {
    background-color: rgb(3, 10, 18);
}

nav a {
    text-decoration: none;
    /* color: rgb(110, 110, 108); */
    color:black;
    margin: 0 15px;
    font-weight: normal;
    
}


.nav a:after,
.nav a:before {
  content: "";
  position: absolute;
  display: block;
  border: 0px solid transparent;
}

.nav a:after {
  width: 0%;
  height: 80%;
  border-top: 2px solid #fff;
  border-bottom: 2px solid #fff;
  transition: all 0.3s ease;
}

.nav a:before {
  width: 120%;
  height: 0%;
  border-left: 2px solid #fff;
  border-right: 2px solid #fff;
  transition: all 0.5s ease;
}

.nav a:hover::before {
  height: 80%;
}

.nav a:hover::after {
  width: 120%;
}

/* Dropdown content */
.hover-content {
    display: none;
    position: absolute;
    top: 85%;
    background-color: #fff;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    padding: 10px;
    margin-left: 40px;
}

.hover-trigger:hover + .hover-content,
.hover-content:hover {
    display: block;
}

.service-item {
    margin-bottom: 5px;
}



.service-item a:hover {
    color: blue;
}


        /* Header styles */
        header {
            background-color: #eee;
            padding: 0px;
            width: 100%;
            text-align: center;
        }
        
        button a{
            color:white;
        }
        .desc{
        
            margin-top:12px;
            
        }
        .cost{
               border-radius: 1px solid black; 
                 /* Adjust as needed */
                width: 100%; /* Ensure button spans the entire width */
                /* Center the button horizontally 
                */
                
        }

       

        
        button[type="submit"] {
            background-color: #007bff;
            margin-top:10px;
            margin-right:170px;
            color: #ffffff;
            border: none;
            border-radius: 4px;
            padding: 5px 15px;
            cursor: pointer;
            font-size: 16px;
        }

        button[type="submit"]:hover {
            background-color: #0056b3;
            color: blue;
        }
        
    
        .btn-primary a:hover {
            color: white; /* color change on hover */
        }

        .main-content{
               display:flex;
               justify-content: flex-start;
        }

        .main-content h1{
            margin-right:30px;
            margin-top:20px;
            font-style:italic;
            font-weight:250;
 
        }
        .form-row{
            gap:50px;
        }

        .form-row>.col, .form-row>[class*=col-]{
            padding:0px;
        }
        
       

        .search {
            
            align-items: center;
        }

        #searched {
        padding: 8px;
        border: 1px solid #ccc;
        border-radius: 4px;
        margin-right: 10px;
        margin-left:32rem;
        margin-top:25px;
        width:500px;
    }

        .middle{
            border:1px solid lightgray;
            padding:30px;
            margin-top:30px;
            position:relative;
            width:320px;
            max-width:90vw;
            margin:20px;
            transition: .3s;
         }

         .desc{
            
            max-width:80vw
         }

         .name{
            color:rgba(0, 108, 228, 1);
            font-weight:2px bold;
         }
        
        .title h3{
            text-decoration:underline;
            margin-top:8px;
            
        }
        .title h4{
            color: green;
            font-weight:bold;
            position:relative;
            margin-top:15px;
            
        }


        /*--*/
       

        .second > .middle:hover{
           
        } 

        .middle:hover{
           transition: .3s;
           transform: scale(1.1);
        } 

                /* CSS for the pop-up box */
        .popup {
            position: fixed;
            top: 50%;
            left: 40%;
            transform: translate(-50%, -50%);
            background-color: white;
            padding: 10px;
            border: 1px solid #ccc;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            z-index: 9999; /* Ensure the pop-up is above other content */
            display: none; /* Initially hide the pop-up */
            width: 300px; 
           
        }

        /* Styling for the close button */
        .popup:target {
            display: block; /* Show the pop-up when it is targeted */
        }

        /* Dim background when pop-up is open */
        .overlay {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            background-color: rgba(0, 0, 0, 0.5); /* Semi-transparent black background */
            backdrop-filter: blur(5px); /* Add blur effect */
            z-index: 998; /* Ensure it's above other content but below pop-up */
            display: none; /* Initially hide the overlay */
        }

        /* Show the overlay when the pop-up is targeted */
        .popup:target + .overlay {
            display: block;
        }

         
        /* CSS for the pop-up box */

      
      
        footer {
            
            background-color: rgba(0, 59, 149, 1);
            color: white;
            text-align: right;
            padding: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center; /* Align items vertically in the center */
         }
        
         .copy {
            background-color: rgba(0, 59, 149, 1);
            color: white;
            text-align: left;
            padding-bottom: 10px;
         }
        
         .company {
            display: flex;
            flex-direction: column;
         }
        
         .company a {
            color: white;
            text-decoration: none;
            margin: 5px 0;
            padding-right: 30px;
            font-size: small;
         }
        
         .company p {
            color: white;
            text-decoration: none;
            margin: 5px 0;
            padding-right: 30px;
            font-size: large;
         }

       
        .search-container {
         
            display: flex;
            align-items: center;
            width:500px;
            max-width:90vw;
            margin:auto;
            margin-top:60px;
            margin-right:350px;
        }

        
        .filters{
                text-align:center;
                margin-left: 360px;
                margin-top: 25px;
            }

            .filter-container {
                display: flex; /* Use Flexbox to align items */
                align-items: center; /* Vertically center items */
            }
            
            .filters {
                text-align: center; /* Center the content horizontally */
                margin-left: 370px; /* Adjust margin as needed */
                margin-top: 25px; /* Adjust margin as needed */
            }
            
            /* Style the link and span inside .filters */
            .filters a {
                text-decoration: none;
                color: black; /* Change to desired color */
                font-size: 18px; /* Adjust font size as needed */
                display: flex; /* Use Flexbox for link contents */
                align-items: center; /* Align items vertically */
            }
            
            .filters a:hover {
                color: blue; /* Change to desired color on hover */
            }
            
            .filters .material-symbols-outlined {
                font-size: 45px; /* Adjust font size as needed */
                margin-left: 5px; /* Adjust margin as needed */
                /* Change to desired color */
            }
            

        .whole{
           
            align-items: center;
            width:100%;
            max-width:90vw;
            margin:auto;
            margin-top:40px;
            margin-left:100px;
        }

        .material-symbols-outlined {
            font-size: 20px; /* Adjust the size of the icon */
            color: gray; /* Adjust the color of the icon */
            margin-right: 10px; /* Adjust spacing between the icon and the input field */
        }

        #searching{
            padding:12px 25px;
            border-radius:10px;
             border:1px solid lightgray
        }
        .btn-container {
            display: flex;
            justify-content: space-between;
            align-items: center; /* vertically center items */
        }
    
        .btn-primary {
            margin-right: 10px; /* adjust spacing between button and text */
        }

        .venue-container {
            display: flex;
            margin-top:0px;
            flex-wrap: wrap;
            margin-left:50px;
          }
           
        /* Style for the input box */
        .form-control {
             width: 100px; /* Set the width of the input box */
        }


        .input-group{
            width:45%;
        }

          
          /* Style for the input box */
   .form-control {
    border-radius: 5px; /* Add border-radius for rounded corners */
    border-color: #ced4da; /* Add border color */
   }

/* Style for the search icon */
   .input-group-text {
    background-color: transparent; /* Set background color of the search icon container */
    border-color: #ced4da; /* Set border color */
   }

/* Adjust padding and border for the search icon */
   .input-group-text > .fa {
    padding: 0.375rem 0.75rem; /* Adjust padding */
    border-left: 1px solid #ced4da; /* Add left border */
   }

   
.logo_img {
        height: auto;
        width: 100px;
        display: block;

    } 
</style>
</head>
<body>

        <!-- To display the messages, use the following tag -->
    {% for message in messages %}
        <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
            <!-- For displaying as bold -->
            <strong>Message:</strong> {{ message }}
            <!-- For closing the message tag -->
            <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                <span aria-hidden="true">&times;</span>
            </button>
        </div>
    {% endfor %} 
    
<!-- After clicking on the home and other text, they follow the following URLs -->
        
    <!-- After clicking on the home and other text, they follow the following URLs -->
    <nav style="display: flex; align-items: center; justify-content: space-between; margin-top: -50px;">
        <div class="logo" style="display: flex;align-items: center;justify-content: center; margin-bottom: -50px;">
            <img class="logo_img" src="{% static 'images/logoa.png' %}">
            <div>
                <a href="/">Home</a>
    
                <a href="#" class="hover-trigger">Services</a>
                <div class="hover-content">
                    <div class="service-item">
                        <a href="/venue">Venues</a>
                    </div>
                    <div class="service-item">
                        <a href="/decorations">Decoration</a>
                    </div>
                    <div class="service-item">
                        <a href="/photographers">Photographer</a>
                    </div>
                </div>
                <a href="/about_us">About Us</a>
                <a href="/contact">Contact</a>
            </div>
        </div>


        <div style="margin-bottom: -50px;">
            <a href="/Register">Register</a>
            <a href="/Login">LogIn</a>
        </div>
    </nav>
    <!-- Main Content -->
    <div class="main-content">
       <div class="whole"> 
        <div class="filter-container">
            <div class="filters">
                <a href="#" id="filterLink" style="display: flex;align-items: center;justify-content: center;"><h2> Filters by </h2><span class="material-symbols-outlined" style="font-size:45px; ">
                    <img style="width: 30px;height: auto;margin-left: 20px;margin-top: -25px;" src="https://cdn-icons-png.flaticon.com/512/6488/6488674.png" alt="">
                    </span></a>
            </div>
            <!-- Add the filter form here -->
            
                <form method="GET"  action="{% url 'filter_venues' %}" id="filterForm" class="popup" style="display: none;width: 400px;height: 400px;">
                    <div class="form-row">
                        <div class="form-group col-12">
                            <div class="input-group">
                                <input class="form-control py-2 border-right-0 border" type="search" id="Name" name="Name_contains" placeholder="Name..." style="margin-left: 20px;width: 200px;margin-top: 30px;" />
                              
                            </div>
                        </div>        
                    </div>
                    <div class="form-row">
                        <div class="form-group col-12">
                            <div class="input-group">
                                <input style="margin-left: 20px;width: 200px;"  class="form-control py-2 border-right-0 border" id="location" type="search" name="Location_exact" placeholder="location..." />
                                
                            </div>
                        </div>        
                    </div>
                   
                    <div class="form-row" style="margin-left: 20px;margin-top: 20px;">
                      <div class="form-group col-md-2 col-lg-2">
                        <label for="viewCountMin">Minimum cost</label>
                        <input type="number" min=0 class="form-control" id="viewCountMin" placeholder="0" name="view_count_min">
                      </div>
                      <br>
                      <div class="form-group col-md-2 col-lg-2">
                        <label for="viewCountMax">Maximum cost</label>
                        <input type="number" min=0 class="form-control" id="viewCountMax" placeholder="10000?" name="view_count_max">
                      </div>
                      {% comment %} <div class="form-group col-md-2 col-lg-2">
                        <label for="publishDateMin">Available date</label>
                        <input type="date" class="form-control" id="publishDateMin" name="date_min">
                      </div>
                      <div class="form-group col-md-2 col-lg-2">
                        <label for="publishDateMax">Publish date maximum</label>
                        <input type="date" class="form-control" id="publishDateMax" name="date_max">
                      </div> {% endcomment %}
                      <div class="form-group col-md-4">
                        {% comment %} <label for="category">Category</label>
                        <select id="category" class="form-control" name="category">
                          <option selected>Choose...</option>
                          {% for cat in categories %}
                          
                          <option value="{{ cat }}">{{ cat }}</option>
                          {% endfor %}
                        </select> {% endcomment %}
                      </div>
                    </div>
                   
                    <div class="form-group">
                      
                        {% comment %} <input class="form-check-input" type="checkbox" id="reviewed" name="reviewed">
                        <label class="form-check-label" for="reviewed">
                          Reviewed
                        </label> {% endcomment %}
                        <button id="filterSearch" class="btn btn-primary" style="margin-top: -40px;width: 50%;margin-left: 20px;">Search</button>
                      
                    </div> 
                    </div>
                    
                  </form>
                <div class="overlay" id="overlay">hello</div>
                  {% comment %} <div id="result" class="venue-container"></div> {% endcomment %}
                  {% comment %} <div id="result" class="filter-container"></div>  {% endcomment %}
        </div>
        
        
        
        <form class="search" method= "GET" action="{% url 'search_venue' %}">
            {% csrf_token %}  <!--cross site request forgery token helps keep hackers from hijacking your form -->
            <div class="search-container">
                    <input type="text" id="searching" name="searched" placeholder="Enter Location" >
                    <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQs2K1Y3RoV2luHhIPC2dD-PKo-RzccHBCxoMbRRBftSA&s" style="width:35px;height:auto;margin-left:-43px">
            </div>        
        </form>
       </div> 
       <div id="result" class="venue-container"></div>
        <h1 style="display:flex;justify-content:flex-start;margin-bottom:50px;margin-top:40px;width:95vw;margin-left:4vw;margin-right:3vw;flex-wrap:wrap;">Our Venues</h1>
        <div class="second" style='display:flex;justify-content:flex-start;margin-bottom:50px;margin-top:40px;width:95vw;margin-left:3vw;margin-right:3vw;flex-wrap:wrap;'>
            
        {% for venue in venues %}
         <div class=" middle" style="border: 1px solid rgb(215, 215, 215);border-radius: 15px;">
           <div class = "car">
            <div class="name">
             <h2 style="color: black;font-weight:500;margin-bottom: 20px;">{{venue.Name}} </h2>
            </div>
            <div class="pictures"> 
                {% if venue.Venue_image.all %}   
                <div class="img"> 
                    <img src="{{ venue.Venue_image.first.image.url }}" alt="{{ venue.Name }}" style="width:260px;height:150px;object-fit:cover;border-radius: 8px;" >
                </div>
            {% endif %}
            </div>
            
             {% comment %} <img src="{{ venues.Venue_image.url }}" alt="{{ venue.Name }}" width="100"> {% endcomment %}
             {% comment %} <img src="{% static 'media/' %}{{ venue.Venue_image }}" alt="{{ venue.Name }}" width="100"> {% endcomment %}      
             
            <div class = "title" style="margin-top: 15px;">
                <h4 style="text-decoration: none;font-weight: 500;font-size: 1.2rem;color: rgb(0, 81, 195);"> {{ venue.Location }}  </h4>
                
                {% comment %} <div class="desc">
                 <p>{{ venue.Description }}</p>
                </div> {% endcomment %}
                <div style="display: flex;align-items: center;flex-direction: column-reverse;">
                    <div class="btn-container"> 
                        <button type="submit" class="btn-primary" style="width: 100px;"><a href="/{{ venue.id }}/explorevenue" style="width: 300px;">Explore</a></button>
                    </div> 

                    <div class="cost" style="color: rgb(0, 169, 0);margin-bottom: 10px;">
                        <h4> रु: {{ venue.Cost }} </h4>
                    </div>    

                </div>
                
                
            </div>
          </div>
         </div>
        {% endfor %}
              
       </div>
    </div>
    
    <!-- Footer -->
    <footer>
        <div class="copy">
            <p>Copyright © 2023
                by Rabina Roka.</p>
        </div>
        <div class="company">
            <p>Company</p>
            <a href="#">Contact Us</a>
            <a href="#">About us</a>
            <a href="#">FAQs</a>
        </div>



    </footer>
   
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <script>
       document.getElementById("searching").addEventListener("input", function(event) {
    const searched = event.target.value;
    if (searched.length > 0) {
        fetch(`/api/search_venue?searched=${searched}`)
            .then(response => response.json())
            .then(data => {
                console.log(data);
                const resultContainer = document.getElementById("result");
                resultContainer.innerHTML = ""; // Clear previous results
                data.venues.forEach(venue => {
                    console.log(venue)
                    const venueHTML = `
                    <div class="middle" style="border: 1px solid rgb(215, 215, 215); border-radius: 15px;">
                        <div class="car">
                            <div class="name">
                                <h2 style="color: black; font-weight: bold; margin-bottom: 20px;">${venue.Name}</h2>
                            </div>
                            <div class="pictures">
                                ${venue.Venue_images && venue.Venue_images.length > 0 ?
                                    `<div class="img">
                                        <img src="${venue.Venue_images[0]}" alt="${venue.Name}" style="width: 260px; height: 150px; object-fit: cover; border-radius: 8px;">
                                    </div>` : ''}
                            </div>
                            <div class="title" style="margin-top: 15px;">
                                <h4 style="text-decoration: none; font-weight: bold; font-size: 1.2rem;color:rgb(103, 103, 192);">${venue.Location}</h4>
                                <div style="display: flex; align-items: center; flex-direction: column-reverse;">
                                    <div class="btn-container">
                                        <button type="submit" class="btn-primary" style="width: 100px; background-color: rgb(0, 81, 195);">
                                            <a href="/${venue.id}/explorevenue" style="width: 300px;">Explore</a>
                                        </button>
                                    </div>
                                    <div class="cost">
                                        <h4>रु: ${venue.Cost}</h4>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>`;
                    resultContainer.innerHTML += venueHTML;
                });
            })
            .catch(error => console.error('Error:', error));
    } else {
        document.getElementById("result").innerHTML = "";
    }
});

    </script>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            var trigger = document.querySelector('.hover-trigger');
            var content = document.querySelector('.hover-content');
            trigger.addEventListener('click', function() {
                if (content.style.display === "block") {
                    content.style.display = "none";
                } else {
                    content.style.display = "block";
                }
            });
        });
        
    </script>
    <script>
        {
            // Get references to the filter form and the result container
            const filterform = document.getElementById("filterForm");
            console.log(filterform)
            const resultContainer = document.getElementById("result");
            
            // Add event listener to the filter form
            filterForm.addEventListener("click", function(event) {
                event.preventDefault()
                console.log("console")
                // Prevent the default form submission behavior
                // Get the filter values from the form inputs
                const location = document.getElementById("location").value;
                const Name = document.getElementById("Name").value;
                const view_count_max = document.getElementById("viewCountMax").value;
                
                const view_count_min = document.getElementById("viewCountMin").value;
            
            
                // Perform the filtering using AJAX
                fetch(`/api/filter_venues?Location_exact=${location}&view_count_max=${view_count_max}&view_count_min=${view_count_min}&Name_contains=${Name}`)
                    .then(response => response.json())
                    .then(data => {
                        console.log(data);
            
            
                        if(data.venues.length==0){
                            console.log("data not found!")
                            // document.getElementById("result").innerHTML = "<p>No venues found</p>";
                            resultContainer.innerHTML="<p style='color: red; font-weight: bold; margin:20px;'>No venues found</p>"
                            return
                        }
                        // Clear previous search results
                        resultContainer.innerHTML = "";
                        // Display new search results
                        data.venues.forEach(venue => {
                            console.log(venue)
                            const venueHTML = `
                    <div class="middle" style="border: 1px solid rgb(215, 215, 215); border-radius: 15px;">
                        <div class="car">
                            <div class="name">
                                <h2 style="color: black; font-weight: bold; margin-bottom: 20px;">${venue.Name}</h2>
                            </div>
                            <div class="pictures">
                                ${venue.Venue_images && venue.Venue_images.length > 0 ?
                                    `<div class="img">
                                        <img src="${venue.Venue_images[0]}" alt="${venue.Name}" style="width: 260px; height: 150px; object-fit: cover; border-radius: 8px;">
                                    </div>` : ''}
                            </div>
                            <div class="title" style="margin-top: 15px;">
                                <h4 style="text-decoration: none; font-weight: bold; font-size: 1.2rem;color:rgb(103, 103, 192);">${venue.Location}</h4>
                                <div style="display: flex; align-items: center; flex-direction: column-reverse;">
                                    <div class="btn-container">
                                        <button type="submit" class="btn-primary" style="width: 100px; background-color: rgb(0, 81, 195);">
                                            <a href="/${venue.id}/explorevenue" style="width: 300px;">Explore</a>
                                        </button>
                                    </div>
                                    <div class="cost">
                                        <h4>रु: ${venue.Cost}</h4>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>`;
                            resultContainer.innerHTML += venueHTML;
                        });
                    })
                    .catch(error => console.error('Error fetching data:', error));
            
            }); 
            }
    </script>
        
    
    <!--location instead of searched-->
    <script src="{% static 'js/script.js' %}"></script>
</body>
</html>